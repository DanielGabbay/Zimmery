# הוראות להגדרת בסיס הנתונים - זימרי

## 🚨 **הבעיה שאתה חווה**

השגיאה שאתה מקבל:
```
"Could not find the table 'public.customers' in the schema cache"
```

**הסיבה:** הטבלאות `customers` ו-`bookings` לא קיימות בבסיס הנתונים שלך בSupabase.

## 🔧 **הפתרון - שלבים מפורטים**

### שלב 1: כניסה ל-Supabase Dashboard
1. **פתח דפדפן** וגש ל-[Supabase Dashboard](https://app.supabase.com/)
2. **התחבר** לחשבון שלך
3. **בחר את הפרויקט** שלך: `kvbyieehwdlbmwqvdivr`

### שלב 2: גישה לעורך ה-SQL
1. בתפריט הצדדי השמאלי, **לחץ על "SQL Editor"**
2. **לחץ על "New Query"** (שאילתה חדשה)

### שלב 3: העתקת הסקריפט המתוקן
1. **פתח את הקובץ** `database-setup-fixed.sql` (בתיקייה הנוכחית)
2. **בחר את כל התוכן** (Ctrl+A או Cmd+A)
3. **העתק** (Ctrl+C או Cmd+C)

⚠️ **חשוב**: השתמש ב-`database-setup-fixed.sql` ולא ב-`database-setup.sql`

### שלב 4: הדבקה וביצוע
1. **בעורך ה-SQL בSupabase**, הדבק את התוכן (Ctrl+V או Cmd+V)
2. **לחץ על כפתור "Run"** (ריצה) - בצד ימין למטה
3. **חכה** עד שהסקריפט יסתיים לרוץ

### שלב 5: וידוא שהטבלאות נוצרו
1. בתפריט הצדדי, **לחץ על "Table Editor"**
2. **בדוק שאתה רואה שתי טבלאות חדשות:**
   - `customers` (לקוחות)
   - `bookings` (הזמנות)

## 🧪 **בדיקה**

אחרי שהרצת את הסקריפט, **בדוק שהכל עובד**:

```bash
node check-db.js
```

אמור להציג:
```
✅ הגישה לטבלת customers עובדת
✅ הגישה לטבלת bookings עובדת
✅ לקוח הבדיקה נוצר בהצלחה
```

## 📊 **מה הסקריפט יוצר**

### טבלאות:
- **`customers`** - פרטי לקוחות (שם, תעודת זהות, טלפון, אימייל)
- **`bookings`** - פרטי הזמנות (תאריכים, מספר אורחים, סכומים, סטטוס)

### תכונות מתקדמות:
- **מפתחות ראשיים** - UUID עבור כל רשומה
- **מפתח זר** - קישור בין הזמנות ללקוחות
- **אינדקסים** - לביצועים מהירים יותר
- **Row Level Security** - אבטחה ברמת השורה
- **Timestamps** - תאריכי יצירה ועדכון אוטומטיים

## 🎯 **אחרי ההגדרה**

כשתסיים את ההגדרה:
1. **השגיאה תיפתר**
2. **יצירת הזמנות חדשות תעבוד**
3. **המערכת תזהה לקוחות חוזרים**
4. **כל הפונקציונליות תפעל כמתוכנן**

## 🆘 **אם משהו לא עובד**

אם עדיין יש שגיאות:
1. **וודא שהסקריפט רץ עד הסוף** ללא שגיאות
2. **רענן את הדף** בSupabase Dashboard
3. **נסה שוב** את הבדיקה עם `node check-db.js`
4. אם עדיין לא עובד - **בדוק שיש לך הרשאות** ליצור טבלאות בפרויקט